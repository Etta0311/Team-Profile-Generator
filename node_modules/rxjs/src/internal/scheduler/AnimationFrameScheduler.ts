import { AsyncAction } from './AsyncAction';
import { AsyncScheduler } from './AsyncScheduler';

export class AnimationFrameScheduler extends AsyncScheduler {
  public flush(action?: AsyncAction<any>): void {
<<<<<<< HEAD
    this._active = true;
    this._scheduled = undefined;

    const { actions } = this;
    let error: any;
    let index = -1;
    action = action || actions.shift()!;
    const count = actions.length;

    do {
      if ((error = action.execute(action.state, action.delay))) {
=======

    this.active = true;
    this.scheduled = undefined;

    const {actions} = this;
    let error: any;
    let index: number = -1;
    let count: number = actions.length;
    action = action || actions.shift();

    do {
      if (error = action.execute(action.state, action.delay)) {
>>>>>>> ba354fa661b4c6906c0342221d686a312a23a3ab
        break;
      }
    } while (++index < count && (action = actions.shift()));

<<<<<<< HEAD
    this._active = false;
=======
    this.active = false;
>>>>>>> ba354fa661b4c6906c0342221d686a312a23a3ab

    if (error) {
      while (++index < count && (action = actions.shift())) {
        action.unsubscribe();
      }
      throw error;
    }
  }
}
